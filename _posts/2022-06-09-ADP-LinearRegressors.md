---
layout: post
title: ADP-linear-regression
subtitle: 선형회귀
author: san9hyun
categories: ADP
banner : /assets/images/banners/machineLearning.jpg
tags: ADP statistics python
---

## 🚪 이전 게시글

ADP 실기 시험 공부를 위해 연재하고 있으며,
첫 포스팅은 [기초 통계량-1](https://predictorssh.github.io/adp/2022/03/11/ADP-statistics-0.html)이며,
해당 포스팅에대한 사전 정보들이 있다. (데이터 셋 등에 관한)<br>

이전 게시글 [상관분석](https://predictorssh.github.io/adp/2022/04/07/ADP-statistics-3.html)에 이어서 작성한 글이다.

## 선형회귀분석
선형회귀 모델은, 종속변수 y와 하나 이상의 독립변수(설명변수) X와의 선형관계를 표현하는 모델이다.<br>
이러한 선형회귀 모델을 만들어서, 종속변수와 독립변수사이의 선형관계를 분석하는 것을 선형회귀 분석이라고 한다.<br>
일반적으로는 종속변수와 독립변수 사이의 관계를 분석하기 위해 선형회귀모델을 사용하지만, 종속변수를 예측하는데 사용하기도 한다.<br>

##  실습
선형회귀분석을 통해 종속변수와 독립변수사이의 선형관계를 분석하고자 한다면,<br>
python의 statsmodels을 활용하는 것이 간편하고, 회귀모델을 만들어서 예측을 수행하려고 한다면 sklearn 라이브러리를 활용할 수 있다.<br>

먼저, statsmodel을 활용해서 회귀분석을 진행해보자<br>
독립변수 하나로 회귀분석을 수행하는 것을 단순회귀분석, 독립변수가 2개 이상일 경우 다중회귀분석이라고 한다.<br>
<br>
먼저, 단순회귀 분석을 수행해보자.<br>

```python
#OLS = Ordinary Least Squares(잔차제곱합을 최소화하는 방법으로 선형모델 생성)
from statsmodels.formula.api import ols

# 하나의 독립변수 atemp와 와 종속변수 count 사이의 관계분석
ols('count~atemp',data=train).fit().summary()
```
간단하다. 이렇게 필요한 라이브러리를 임포트한 후, 코드 한줄이면 회귀 분석을 할 수 있다.<br>
첫번째 매개변수로 '종속변수~독립변수' 필드명(컬럼며을 입력해주고) 두번째 독립변수로 해당 필드가 있는 데이터셋을 입력해주면된다.<br>
<br>
저 한줄짜리 코드의 결과를 보자<br>

![ols_result](/assets/images/contents/Linear_Regression/ols_result.PNG)

먼저, 결과의 윗쪽 박스 내용을 보면, 모델의 적합도 유의성을 확인할 수 있다.<br>

- Prob (F-statistic) : 필자는 이 값을 제일 먼저 확인하는데, 이 값은 모델의 유의성을 검정했을떄 p-value로, 값이 유의수준보다 크면 모델이 유의하지 않다는 의미이다.
따라서 이값이 크면, 다른 값들은 쳐다볼 필요가 없다. 분석한 결과 p-value는 0으로 모델은 유의하다. 모델 유의성을 검정하기 위한 귀무가설은 '모든 회귀계수의 기울기가 0이다.'
  이고 대립가설은 '적어도 하나의 회귀계수는 0이 아니다.'이다.

- R-squared : 결정 계수라고 하며, 모델의 설명력을 의미한다. 쉽게 말해서 값이 클수록 이 모델로 데이터를 잘 설명할 수 있다는 뜻이다. 해당 모델에서는 0.152로 값이 낮게 나왔지만, 
종속변수와 독립 변수의 관계를 분석할땐 결정계수의 크기는 크게 중요하지 않다. 더욱이, 독립변수 한개로 진행하는 단순선형회귀 분석에서 결정계수가 높게 나오기는 힘들다.
  만약, 예측을 위한 몇가지 다중회귀 모델의 성능을 비교한다면 결정계수가 큰 모델을 선택해야한다.
  
- Adj R-squared : 수정 결정계수이다. 결정계수는, 단순히 독립변수의 '개수'가 많아지면 커지게 되어있다. 수정 결정 계수는 독립 변수의 개수에 따른 결정계수의 증가를 보정해준 값이다.
따라서 다중회귀분석을 할때는 결정 계수가 아닌, 수정 결정 계수를 확인해야한다. 현 모델은 단순회귀분석으로 결정계수와 수정 결정계수의 값이 같다.

<br>
아래쪽 박스에서는 회귀계수에 대한 분석결과를 확인할 수 있다.<br> 
- coef : atemp 변수의 coef가 8.3316 이다. 이말은 atemp가 1단위 증가할때 count가 8.3316 단위만큼 증가한다는 것이다. 

- P : '회귀계수가 0이다'를 귀무가설로하고 가설검정했을때 p-value이다. 유의 수준보다 낮으면 회귀계수가 0이 아니고, coef의 값이 유의미하다라고 판단 할 수 있다. 

<br>
다중회귀 분석도, 단순회귀 분석과 같은 라이브러리와 모듈을 활용하면 된다.<br>
첫번째 매개변수로 '종속변수~독립변수+독립변수' 처럼 독립변수 필드명을 '+' 로 연결해주기만 하면된다.

```python
ols('count~weather+atemp+humidity+windspeed',data=train).fit().summary()
```

코드 결과는 아래와 같다.<br>

![ols_result](/assets/images/contents/Linear_Regression/multi_ols_result.PNG)

해석도 단순회귀분석과 같은 방법으로 하면 된다.<br>

다중회귀모델의 R-squared가 단순회귀보다 소폭 상승한 것을 알 수 있지만, 모델의 설명력이 그리 좋지 못하다.<br>
예측모델을 만들려면, 선형회귀 모델이 아닌 다른 모델을 만들어야 할 것이다.<br>

그리고, weather의 회귀계수의 p-value가 0.167로 0.1보다 크다.<br> 
따라서, weather의 coef는 유의하지 않다는 의미이다. 

## 📌 정리
간단하게 회귀 분석을 실습하고, 결과를 해석해보았다.<br>
회귀 분석결과 weather는 count와 선형관계가 없어보이고, 선형 모델의 설명력이 그리 좋지 못함으로 비선형 모델을 만들어서 예측을 수행할 필요가 있다.

다중공선성(독립변수 사이의 상관관계)와 스케일링(필드별 데이터 크기차이 조정)를 수행하지는 않았다.<br>
현재 데이터의 필드들은 주로 계절과 날씨에서 파생된 데이터로, 다중공선성이 존재할 것으로 예측되며, <br>
이전에 수행한 상관분석에서도 독립 변수 사이의 높은 상관관계과 관찰되었다. [상관분석 게시글](https://predictorssh.github.io/adp/2022/03/31/ADP-statistics-2.html)

따라서 pca나 변수 선택 기법을 활용해서 다중공선성을 제거해줄 필요가 있다. 

## 🎬 다음 이야기
다음 포스팅은 회귀 모델을 만들어 예측을 수행해볼 것이며,<br>
모델의 정확도 상승을 위해 다중공선성 제거, 스케일링을 진행해볼 것이다!!
